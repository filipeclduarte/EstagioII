---
title: "Estágio Supervisionado II"
output:
  html_document:
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

# Aula 2

Nesta aula veremos as operações condicionais, como criar funções e as distribuições de frequência e severidade.

## Operações Condicionais

Os operadores de comparação são:

* Igualdade: ==
* Não igual: !=
* Menor: <
* Maior: >
* Menor ou igual: <=
* Maior ou igual: >=

Operadores lógicos são:

* E: &
* Ou: |

A partir desses operadores, utilizaremos a função `if()` para avaliar as condições lógicas.

A sintaxe de uma operação lógica pode ser expressa a partir dessa função `if()`, em que o seu argumento será a condição com operadores de comparação e/ou lógicos. 

Se quiser rodar um determinado código apenas se a condição for verdadeira e se a condição for falsa, queremos que nada seja feito, então:

if (condição) {
    comandos a serem executados caso a codição seja verdadeira
}

Exemplo: Imprima (use a função `paste()`) o valor da variável **C** se o seu valor for menor do que 10:
```{r}
# testando C = 7
C <- 7
if(C<10){
  paste(C)
}
# testando C = 12
C <- 12
if(C<10){
  paste(C)
}
C <- 1
```

Perceba que ao atribuir o valor 12 à C, nada acontece. Isso ocorre porque a condição (C<10) não foi verdadeira. 

Esse tipo de operação não é muito comum na prática, na verdade você gostaria que algo fosse realizado quando a condição não fosse verdadeira. Neste caso, utiliza-se a operação `else` após a chave "}" da função `if()`. Por exemplo, no exemplo anterior caso a condição não seja verificada, peça para imprimir a frase: "O valor de C é maior ou igual a 10!":

```{r}
C <- 12
if(C<10){
  paste(C)
}else{
  paste("O valor de C é maior ou igual a 10!")
}
```

Vamos utilizar outros operadores de comparação. Escreva um código que escreve o valor de **D** se ele for igual a 5. Se o valor de **D** for diferente de 5, imprima: "tente outra vez!"

```{r}
D <- 5
if(D == 5){
  paste(D)
}else{
  paste("tente outra vez!")
}

D <- 6
if(D == 5){
  paste(D)
}else{
  paste("tente outra vez!")
}

```

Quando desejar utilizar algum operador lógico, se você desejar que duas condições sejam verdadeiras, utilize e `&`, ao passo que quando desejar que pelo menos uma seja verdadeira, use `|`. Veremos abaixo como aplicar esse operadores ao criar um teste que se **C** for igual a 7 e **D** for igual a 5, o programa imprimirá ambos os valores com um "verdadeiro" em seguida. Se pelo menos uma das condições não forem verdadeiras, imprima os valores e "falso" em seguida. 

```{r}
C <- 7
D <- 5
if(C==7 & D==5){
  paste("C =",C," e ","D =",D," ","verdadeiro")
}else{
  paste("C =",C," e ","D =",D," ","falso")
}
# testar falso
C <- 6
if(C==7 & D==5){
  paste("C =",C," e ","D =",D," ","verdadeiro")
}else{
  paste("C =",C," e ","D =",D," ","falso")
}

```

Agora, faça a mesma função sendo que substitua o operador `&` pelo `|`. Dessa forma, a condição só será falsa se ambos os valores forem diferentes.

```{r}

```


Faça agora um teste com dois valores **A** e **B** recebendo 4 e 3, respectivamente e avalia se **A** for diferente de **B** e maior do que 3, o programa vai imprimir uma mensagem: "o valor está correto!". Caso contrário, ele imprime a mensagem: "não foi desta vez!".

```{r}

```


## Criando Funções

Uma função serve para que possamos automatizar os cálculos. Toda vez que você se deparar com algum problema em que será necessária a utilização repetidamente de um cálculo ou uma certa tarefa, crie uma função para automatizar o procedimento. 

Para se criar uma função, basta atribuir um nome a sua função e utilizar a função `function()` com os parâmetros necessários. Por exemplo, vamos criar uma função que recebe dois valores, x1 e x2, e calcula o produto deles. 

```{r}
# criando a função
minha_funcao <- function(x1, x2){
  return(x1 * x2)
}

# vamos testar
minha_funcao(x1 = 20, x2 = 2)
minha_funcao(20,4)
```

Agora é sua vez, crie uma função que recebe dois valores e imprime o maior. 

```{r}
func <- function(x,y){
  return(max(x,y))
}
func(10,20)
```

Escreva uma função que calcula o valor presente (desconto financeiro) ao receber um valor futuro, uma taxa de juros e um período.

```{r}

```

Faça agora uma função que calcula a média de um vetor e imprime "A média é `media_calculada`". Utilize a função `sum()` que soma os valores e a função `length()` que diz a quantidade de elementos do vetor. 

```{r}


```

Por fim, Escreva uma função que recebe um vetor e se a soma do vetor for maior do que zero e menor do que 1000, ele calcula e retorna a quantidade de elementos, a média e o desvio-padrão. Caso contrário, ele imprime a mensagem: "o valor está fora dos parâmetros exigidos."

```{r}
funcao <- function(x){
  if(sum(x) > 0 & sum(x) < 1000){
    return(c(length(x), mean(x), sd(x)))
  }else{
    return(paste("o valor está fora dos parâmetros exigidos."))
  }
}

funcao(seq(1,10))
funcao(c(5, 100, 40, 30))
funcao(rnorm(150, 5, 1))
```

## Distribuições de Sinistros

### Frequência (N)

As distribuições discretas mais comuns que modelam a variável **Frequência de Sinistros** são:

* Poisson
* Binomial Negativa
* Geométrica

#### Distribuição de Poisson

A distribuição de Poisson só possui um parâmetros que é o $\lambda$. Uma propriedade interessante da Poisson é que o valor esperado é igual à variância, sendo ambas o valor de $\lambda$. 

Para calcular no `R` a probabilidade de **N** assumir algum valor **n**, basta utilizar a função `dpois()`, em que o primeiro argumento representa **n**, e o segundo o seu parâmetro lambda. 

Calcule a probabilidade de N ser igual a 3 para uma distribuição Poisson com lambda = 2:

```{r}
dpois(x=3,lambda=2)
```

Se desejar calcular a probabilidade acumulada, utilize a função `ppois()`. Calcule a probabilidade de **N** ser menor ou igual a 3, para a distribuição do exemplo anterior:

```{r}
ppois(q=3, lambda=2)
```

#### Distribuição Binomial Negativa

A distribuição Binomial Negativa possui dois parâmetros, **r** e **p** que representam, respectivamente, a quantidade de suceccos e a probabilidade de sucesso. O seu valor esperado é: $E[N] = \frac{r(1-p)}{p}$, enquanto a variância, $V[N] = \frac{r(1-p)}{p^2}$.

Para calcular no `R` a probabilidade de **N** assumir algum valor **n**, basta utilizar a função `dnbinom()`, em que o primeiro argumento representa **n**, o segundo representa o **r**, e o terceiro a probabilidade de sucesso **p**.

Calcule a probabilidade de N ser igual a 3 para uma distribuição Binomial Negativa com r = 10 e p = 0,8:

```{r}
dnbinom(x=3,size=10,prob=0.8)
```

Se desejar calcular a probabilidade acumulada, utilize a função `pnbinom()`. Calcule a probabilidade de **N** ser menor ou igual a 3, para a distribuição do exemplo anterior:

```{r}
pnbinom(q=3,size=10,prob = 0.8)
```

#### Distribuição Geométrica

É um caso especial da binomial negativa quando **r** é igual a 1. 

### Severidade

As distribuições discretas mais comuns que modelam a variável **Severidade** ou **Valor de 1 sinistro** são:

* Gama
* Log-Normal
* Pareto
* Weibull

#### Distribuição Gama

A distribuição Gama é da família das distribuições contínuas de dois parametros. Ela é usada para modelar variáveis de valores positivos que possuem assimetria positiva. Sendo assim, a distribuição Gama é normalmente utilizada para representar os valores dos Sinistros ou empregada em Estudos de Sobrevivência. 

Os seus parâmetros são de forma ($\alpha$) e de escala inversa ($\beta$).

Para calcular no `R` a probabilidade de **X** assumir algum valor **x**, basta utilizar a função `dgamma()`, em que o primeiro argumento representa **x**, o segundo sendo o parâmetro de forma $\alpha$ e o parâmetro de escala $\beta$. 

O valor esperado da distribuição gama é: $$E[X] = \frac{\alpha}{\beta}$$

A variância é: $$V[X] = \frac{\alpha}{\beta^2}$$

Dessa forma, calcule a probabilidade de x ser igual a $1000$ para uma distribuição $GAMA(3,0.001)$:

```{r}
dgamma(x = 1000, shape = 3, rate = 0.001)
```


Se desejar calcular a probabilidade acumulada, utilize a função `pgamma()`. Calcule a probabilidade de **X** ser menor ou igual a 1000, para a distribuição do exemplo anterior:

```{r}
pgamma(q = 1000, shape = 3, rate = 0.001)
```

Sua vez: Calcule a probabilidade de um sinistro superar 10000 para a distribuição do exemplo anterior:

```{r}

```


#### Distribuição Log-Normal

A variável aleatóriatem distribuição Log-Normal ($X$) quando seu logaritmo natural tem distribuição Normal $Y = ln(X)$.


Então, dada uma distribuição Log-Normal $X$ com $\mu$ sendo a média e $\sigma$ o seu desvio-padrão, o Logaritmo de $X$ é distribuido normalmente, como segue:

$$
X = e^{\mu + Z\sigma}
$$
em que $Z$ é a variável normal padrão. 

Sua função de densidade é:

$$
f(x;\mu, \sigma) = \frac{1}{x\sigma\sqrt{2\pi}}exp\bigg[{-\frac{(ln(x)-\mu)^2}{2\sigma^2}}\bigg]
$$

O valor esperado de $X$ (log-Normal) $X = e^Y$, quando $Y$ é uma variável aleatória normal é:

$$
E[X] = E[e^Y] = e^{(E[Y] + \frac{1}{2}Var[Y])}
$$

A variância de $X$ (Log-Normal) pode ser expressa em função da Normal ($Y$), sendo $X = exp(Y)$:

$$ 
Var[X] = e^{(2E[Y]+Var[Y])(e^{(Var[Y])-1})}
$$

Para calcular a probabilidade de X ser igual a um valor, utilize a função `plnorm()`, em que temos o parâmetro $\mu$ e $\sigma$.

#### Distribuição Weibull


